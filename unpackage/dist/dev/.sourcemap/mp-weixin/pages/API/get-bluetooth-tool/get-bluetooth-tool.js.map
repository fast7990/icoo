{"version":3,"sources":["webpack:///./I:/HBX/icoo/pages/API/get-bluetooth-tool/get-bluetooth-tool.js","webpack:///I:/HBX/icoo/pages/API/get-bluetooth-tool/get-bluetooth-tool.vue","webpack:///./I:/HBX/icoo/pages/API/get-bluetooth-tool/get-bluetooth-tool.vue","webpack:///./I:/HBX/icoo/common/util/bluetooth.js","webpack:///./I:/HBX/icoo/common/mixins.js","webpack:///I:/HBX/icoo/pages/API/get-bluetooth-tool/get-bluetooth-tool.vue?7cbd"],"names":["__webpack_require__","Page","_mpvuePageFactory2","default","App","__WEBPACK_IMPORTED_MODULE_1__HBuilderX_1_1_0_20181030_full_HBuilderX_plugins_uniapp_lib_mpvue_loader_lib_template_compiler_index_id_data_v_36b9c0cb_hasScoped_true_preserveWhitespace_false_HBuilderX_1_1_0_20181030_full_HBuilderX_plugins_uniapp_lib_preprocessor_loader_js_type_html_context_MP_WEIXIN_true_HBuilderX_1_1_0_20181030_full_HBuilderX_plugins_uniapp_lib_mpvue_loader_lib_selector_type_template_index_0_get_bluetooth_tool_vue__","disposed","__vue_styles__","ssrContext","Component","normalizeComponent","__WEBPACK_IMPORTED_MODULE_0__HBuilderX_1_1_0_20181030_full_HBuilderX_plugins_uniapp_node_modules_babel_loader_babelrc_false_retainLines_true_presets_I_HBuilderX_1_1_0_20181030_full_HBuilderX_plugins_uniapp_node_modules_babel_preset_env_modules_commonjs_targets_browsers_1_last_2_versions_not_ie_8_I_HBuilderX_1_1_0_20181030_full_HBuilderX_plugins_uniapp_node_modules_babel_preset_stage_2_plugins_I_HBuilderX_1_1_0_20181030_full_HBuilderX_plugins_uniapp_node_modules_babel_plugin_transform_runtime_helpers_false_polyfill_false_regenerator_true_moduleName_I_HBuilderX_1_1_0_20181030_full_HBuilderX_plugins_uniapp_node_modules_babel_runtime_I_HBuilderX_1_1_0_20181030_full_HBuilderX_plugins_uniapp_node_modules_babel_plugin_transform_decorators_legacy_HBuilderX_1_1_0_20181030_full_HBuilderX_plugins_uniapp_lib_preprocessor_loader_js_type_js_context_MP_WEIXIN_true_HBuilderX_1_1_0_20181030_full_HBuilderX_plugins_uniapp_lib_mpvue_loader_lib_selector_type_script_index_0_get_bluetooth_tool_vue___default","a","options","__file","esModule","Object","keys","some","key","substr","console","error","functional","__webpack_exports__","_bluetooth","_mixins","mixins","childMixin","data","status","sousuo","msg","msg1","connectedDeviceId","services","characteristics","writeServicweId","writeCharacteristicsId","readServicweId","readCharacteristicsId","notifyServicweId","notifyCharacteristicsId","inputValue","devices","characteristics1","onLoad","wx","openBluetoothAdapter","showModal","title","content","methods","connectTO","e","bluetooth","this","initOpen","state","result","closeBLEDevices","closeBLEConnection","findBLEDevices","startBluetoothDevicesDiscovery","stopFindBLEDevices","stopBluetoothDevicesDiscovery","getBluetoothDevices","onBluetoothDeviceFound","sendBLEValueChange","notifyBLEValueChange","getBLEValueChange","getBluetoothState","getBluetoothAdapterState","getBLEDeviceServices","getBLEDeviceCharacteristics","arg","_classCallCheck","_this","callback","that","success","res","log","JSON","stringify","onBluetoothAdapterStateChange","discovering","available","fail","errMsg","getConnectedBluetoothDevices","i","length","name","push","indexOf","deviceId","_typeof","currentTarget","id","createBLEConnection","toString","onBLEConnectionStateChange","connected","complete","serviceId","onBLECharacteristicValueChange","hex","ab2hex","value","senddata","buffer","ArrayBuffer","dataView","DataView","setUint8","writeBLECharacteristicValue","characteristicId","notifyBLECharacteristicValueChange","characteristic","readBLECharacteristicValue","closeBluetoothAdapter","Array","prototype","map","call","Uint8Array","bit","slice","popupShowState","top","middle","bottom","popupShowMask","activePop","onBackPress","hide","popupShow","evt","pos","popupHide","render","_vm","_h","$createElement","_c","_self","staticClass","directives","rawName","expression","attrs","eventid","on","tap","_v","_s","jieshou","type","domProps","input","$event","target","composing","_l","item","index","_withStripped","esExports","staticRenderFns"],"mappings":"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","file":"pages/API//get-bluetooth-tool/get-bluetooth-tool.js","sourcesContent":["\nimport pageFactory from 'mpvue-page-factory'\nimport App from 'I:/HBX/icoo/pages/API/get-bluetooth-tool/get-bluetooth-tool.vue'\nPage(pageFactory(App))\n\n\n\n// WEBPACK FOOTER //\n// ./I:/HBX/icoo/pages/API/get-bluetooth-tool/get-bluetooth-tool.js","var disposed = false\nfunction injectStyle (ssrContext) {\n  if (disposed) return\n  require(\"!!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/node_modules/vue-style-loader!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/css-var-loader.js!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/node_modules/css-loader?{\\\"minimize\\\":false,\\\"sourceMap\\\":false}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/mpvue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-36b9c0cb\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/node_modules/px2rpx-loader?{\\\"baseDpr\\\":1,\\\"rpxUnit\\\":1}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/css-upx-loader.js?{\\\"baseDpr\\\":1,\\\"rpxUnit\\\":1}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/preprocessor-loader.js?{\\\"type\\\":\\\"js\\\",\\\"context\\\":{\\\"MP-WEIXIN\\\":true}}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/node_modules/postcss-loader?{\\\"config\\\":{\\\"path\\\":\\\"I:\\\\\\\\HBuilderX.1.1.0.20181030.full\\\\\\\\HBuilderX\\\\\\\\plugins\\\\\\\\uniapp\\\\\\\\.postcssrc.js\\\"},\\\"sourceMap\\\":true}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/preprocessor-loader.js?{\\\"type\\\":\\\"js\\\",\\\"context\\\":{\\\"MP-WEIXIN\\\":true}}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/mpvue-loader/lib/selector?type=styles&index=0!./get-bluetooth-tool.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/mpvue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/node_modules/babel-loader?{\\\"babelrc\\\":false,\\\"retainLines\\\":true,\\\"presets\\\":[[\\\"I:\\\\\\\\HBuilderX.1.1.0.20181030.full\\\\\\\\HBuilderX\\\\\\\\plugins\\\\\\\\uniapp\\\\\\\\node_modules\\\\\\\\babel-preset-env\\\",{\\\"modules\\\":\\\"commonjs\\\",\\\"targets\\\":{\\\"browsers\\\":[\\\"> 1%\\\",\\\"last 2 versions\\\",\\\"not ie <= 8\\\"]}}],\\\"I:\\\\\\\\HBuilderX.1.1.0.20181030.full\\\\\\\\HBuilderX\\\\\\\\plugins\\\\\\\\uniapp\\\\\\\\node_modules\\\\\\\\babel-preset-stage-2\\\"],\\\"plugins\\\":[[\\\"I:\\\\\\\\HBuilderX.1.1.0.20181030.full\\\\\\\\HBuilderX\\\\\\\\plugins\\\\\\\\uniapp\\\\\\\\node_modules\\\\\\\\babel-plugin-transform-runtime\\\",{\\\"helpers\\\":false,\\\"polyfill\\\":false,\\\"regenerator\\\":true,\\\"moduleName\\\":\\\"I:\\\\\\\\HBuilderX.1.1.0.20181030.full\\\\\\\\HBuilderX\\\\\\\\plugins\\\\\\\\uniapp\\\\\\\\node_modules\\\\\\\\babel-runtime\\\"}],\\\"I:\\\\\\\\HBuilderX.1.1.0.20181030.full\\\\\\\\HBuilderX\\\\\\\\plugins\\\\\\\\uniapp\\\\\\\\node_modules\\\\\\\\babel-plugin-transform-decorators-legacy\\\"]}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/preprocessor-loader.js?{\\\"type\\\":\\\"js\\\",\\\"context\\\":{\\\"MP-WEIXIN\\\":true}}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/mpvue-loader/lib/selector?type=script&index=0!./get-bluetooth-tool.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/mpvue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-36b9c0cb\\\",\\\"hasScoped\\\":true,\\\"preserveWhitespace\\\":false}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/preprocessor-loader.js?{\\\"type\\\":\\\"html\\\",\\\"context\\\":{\\\"MP-WEIXIN\\\":true}}!../../../../../HBuilderX.1.1.0.20181030.full/HBuilderX/plugins/uniapp/lib/mpvue-loader/lib/selector?type=template&index=0!./get-bluetooth-tool.vue\"\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-36b9c0cb\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\nComponent.options.__file = \"..\\\\..\\\\..\\\\..\\\\HBX\\\\icoo\\\\pages\\\\API\\\\get-bluetooth-tool\\\\get-bluetooth-tool.vue\"\nif (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== \"default\" && key.substr(0, 2) !== \"__\"})) {console.error(\"named exports are not supported in *.vue files.\")}\nif (Component.options.functional) {console.error(\"[vue-loader] get-bluetooth-tool.vue: functional components are not supported with templates, they should use render functions.\")}\n\n/* hot reload */\nif (module.hot) {(function () {\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-36b9c0cb\", Component.options)\n  } else {\n    hotAPI.reload(\"data-v-36b9c0cb\", Component.options)\n  }\n  module.hot.dispose(function (data) {\n    disposed = true\n  })\n})()}\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// I:/HBX/icoo/pages/API/get-bluetooth-tool/get-bluetooth-tool.vue\n// module id = 48\n// module chunks = 3","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport bluetooth from '../../../common/util/bluetooth'\nimport {\n\tchildMixin\n} from '../../../common/mixins'\n\nfunction inArray(arr, key, val) {\n\tfor (let i = 0; i < arr.length; i++) {\n\t\tif (arr[i][key] === val) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\n// ArrayBuffer转16进度字符串示例\nfunction ab2hex(buffer) {\n\tvar hexArr = Array.prototype.map.call(\n\t\tnew Uint8Array(buffer),\n\t\tfunction(bit) {\n\t\t\treturn ('00' + bit.toString(16)).slice(-2)\n\t\t}\n\t)\n\treturn hexArr.join('');\n}\nexport default {\n\tmixins: [childMixin],\n\tdata() {\n\t\treturn {\n\t\t\tstatus: \"\",\n\t\t\tsousuo: \"\",\n\t\t\tmsg: \"\",\n\t\t\tmsg1: \"\",\n\t\t\tconnectedDeviceId: \"\", //已连接设备uuid\n\t\t\tservices: \"00001000-0000-1000-8000-00805f9b34fb\", // 连接设备的服务\n\t\t\tcharacteristics: \"\", // 连接设备的状态值\n\t\t\twriteServicweId: \"00001000-0000-1000-8000-00805f9b34fb\", // 可写服务uuid\n\t\t\twriteCharacteristicsId: \"00001001-0000-1000-8000-00805f9b34fb\", //可写特征值uuid\n\t\t\treadServicweId: \"00001000-0000-1000-8000-00805f9b34fb\", // 可读服务uuid\n\t\t\treadCharacteristicsId: \"00001005-0000-1000-8000-00805f9b34fb\", //可读特征值uuid\n\t\t\tnotifyServicweId: \"00001000-0000-1000-8000-00805f9b34fb\", //通知服务UUid\n\t\t\tnotifyCharacteristicsId: \"00001002-0000-1000-8000-00805f9b34fb\", //通知特征值UUID\n\t\t\tinputValue: '85',\n\t\t\tdevices: [],\n\t\t\tcharacteristics1: \"\" // 连接设备的状态值\n\t\t}\n\t},\n\tonLoad: function() {\n\t\tif (wx.openBluetoothAdapter) {\n\t\t\twx.openBluetoothAdapter()\n\t\t} else {\n\t\t\t// 如果希望用户在最新版本的客户端上体验您的小程序，可以这样子提示\n\t\t\twx.showModal({\n\t\t\t\ttitle: '提示',\n\t\t\t\tcontent: '当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。'\n\t\t\t})\n\t\t}\n\n\t},\n\tmethods: {\n\t\tconnectTO(e) {\n\t\t\tbluetooth.connectTO(e, this,function(){});\n\t\t},\n\t\tinitOpen() {\n\t\t\tbluetooth.openBluetoothAdapter(this, function(state, result) {\n\t\t\t\tif (!state) {\n\t\t\t\t\twx.showModal({\n\t\t\t\t\t\ttitle: '蓝牙未打开',\n\t\t\t\t\t\tcontent: '请打开蓝牙后重试连接'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn state;\n\t\t\t});\n\t\t},\n\t\tcloseBLEDevices() {\n\t\t\tbluetooth.closeBLEConnection(this);\n\t\t},\n\t\tfindBLEDevices() {\n\t\t\tbluetooth.startBluetoothDevicesDiscovery(this, function(state, result) {})\n\t\t},\n\t\tstopFindBLEDevices() {\n\t\t\tbluetooth.stopBluetoothDevicesDiscovery(this, function(state, result) {});\n\t\t},\n\t\tgetBluetoothDevices() {\n\t\t\tbluetooth.getBluetoothDevices(this); //获取所有设备\n\t\t\tbluetooth.onBluetoothDeviceFound(this); //监听发现的设备\n\t\t},\n\t\tsendBLEValueChange() {\n\t\t\tbluetooth.sendBLEValueChange(this,function(){});\n\t\t},\n\t\tnotifyBLEValueChange() {\n\t\t\tbluetooth.notifyBLEValueChange(this,function(){});\n\t\t},\n\t\tgetBLEValueChange() {\n\t\t\tbluetooth.getBLEValueChange(this);\n\t\t},\n\t\tgetBluetoothState() {\n\t\t\tbluetooth.getBluetoothAdapterState(this);\n\t\t},\n\t\tgetBLEDeviceServices() {\n\t\t\tbluetooth.getBLEDeviceServices(this);\n\t\t},\n\t\tgetBLEDeviceCharacteristics() {\n\t\t\tbluetooth.getBLEDeviceCharacteristics(this);\n\t\t}\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./I:/HBX/icoo/pages/API/get-bluetooth-tool/get-bluetooth-tool.vue","class bluetooth {\r\n\tconstructor(arg) {\r\n\r\n\t}\r\n\t/** \r\n\t * 初始化蓝牙适配器\r\n\t * @param {Object} str\r\n\t * @return {Boolean} 返回值 \r\n\t * @author xxx \r\n\t */\r\n\topenBluetoothAdapter(_this, callback) {\r\n\t\tvar that = _this;\r\n\t\twx.openBluetoothAdapter({\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\tconsole.log(\"初始化蓝牙适配器成功！\" + JSON.stringify(res));\r\n\t\t\t\t//监听蓝牙适配器状态\r\n\t\t\t\twx.onBluetoothAdapterStateChange(function(res) {\r\n\t\t\t\t\tconsole.log(res.discovering ? \"在搜索。\" : \"未搜索。\");\r\n\t\t\t\t\tconsole.log(res.available ? \"可用。\" : \"不可用。\");\r\n\t\t\t\t})\r\n\t\t\t\tconsole.log(that.msg);\r\n\t\t\t\tcallback(true, res);\r\n\t\t\t},\r\n\t\t\tfail: function(res) {\r\n\t\t\t\tconsole.log(res);\r\n\t\t\t\tcallback(false, res);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 本机蓝牙适配器状态\r\n\tgetBluetoothAdapterState(_this) {\r\n\t\tvar that = _this;\r\n\t\twx.getBluetoothAdapterState({\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\tthat.msg = \"本机蓝牙适配器状态\" + \"/\" + JSON.stringify(res.errMsg);\r\n\t\t\t\tconsole.log(res.discovering ? \"在搜索。\" : \"未搜索。\");\r\n\t\t\t\tconsole.log(res.available ? \"可用。\" : \"不可用。\");\r\n\t\t\t\t//监听蓝牙适配器状态\r\n\t\t\t\twx.onBluetoothAdapterStateChange(function(res) {\r\n\t\t\t\t\tconsole.log(res.discovering ? \"在搜索。\" : \"未搜索。\");\r\n\t\t\t\t\tconsole.log(res.available ? \"可用。\" : \"不可用。\");\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tfail: function(res) {\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\t/** \r\n\t * 搜索蓝牙设备\r\n\t * @param {Object} str\r\n\t * @return {Boolean} 返回值 \r\n\t * @author xxx \r\n\t */\r\n\tstartBluetoothDevicesDiscovery(_this, callback) {\r\n\t\tvar that = _this;\r\n\t\tthat.devices = [];\r\n\t\twx.startBluetoothDevicesDiscovery({\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\tthat.msg = \"搜索设备\" + JSON.stringify(res);\r\n\t\t\t\t//监听蓝牙适配器状态\r\n\t\t\t\twx.onBluetoothAdapterStateChange(function(res) {\r\n\t\t\t\t\tconsole.log(res.discovering ? \"在搜索。\" : \"未搜索。\");\r\n\t\t\t\t\tconsole.log(res.available ? \"可用。\" : \"不可用。\");\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(\"开始搜索设备成功:\", res);\r\n\t\t\t\tcallback(true, res);\r\n\t\t\t},\r\n\t\t\tfail: function(res) {\r\n\t\t\t\tcallback(false, res);\r\n\t\t\t\tconsole.log(\"搜索失败：\", res)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\t/** \r\n\t * 获取所有已发现的设备\r\n\t * @param {Object} str\r\n\t * @return {Boolean} 返回值 \r\n\t * @author xxx \r\n\t */\r\n\tgetBluetoothDevices(_this) {\r\n\t\tvar that = _this;\r\n\t\tthat.devices = [];\r\n\t\tlet deviceId = that.connectedDeviceId;\r\n\t\twx.getBluetoothDevices({\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\t//根据 uuid 获取处于已连接状态的设备\r\n\t\t\t\twx.getConnectedBluetoothDevices({\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tconsole.log(\"发现设备状态\", JSON.stringify(res));\r\n\t\t\t\t\t\tif (res.devices[0]) {\r\n\t\t\t\t\t\t\tconsole.log(\"已连接设备\");\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// that.connectedDeviceId = res.deviceId;\r\n\t\t\t\t\t\t//5s内未搜索到设备，关闭搜索，关闭蓝牙模块\r\n\t\t\t\t\t\t// \t\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t// \t\t\t\t\t\t\t\tif (!that.deviceId) {\r\n\t\t\t\t\t\t// \t\t\t\t\t\t\t\t\t//关闭搜索\r\n\t\t\t\t\t\t// \t\t\t\t\t\t\t\t\tconsole.log('超时关闭');\r\n\t\t\t\t\t\t// \t\t\t\t\t\t\t\t\tthat.stopFindBLEDevices();\r\n\t\t\t\t\t\t// \t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// \t\t\t\t\t\t\t}, 5000);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function(res) {\r\n\t\t\t\t\t\tconsole.log(\"获取失败\", res)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tlet devices = []\r\n\t\t\t\tfor (let i = 0; i < res.devices.length; i++) {\r\n\t\t\t\t\tif (res.devices[i].name != \"未知设备\") {\r\n\t\t\t\t\t\tdevices.push(res.devices[i])\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthat.devices = devices;\r\n\t\t\t\tconsole.log(\"获取所有已发现的设备\", res.devices);\r\n\t\t\t\t// that.msg = \"搜索设备\" + JSON.stringify(res.devices);\r\n\t\t\t\t//监听蓝牙适配器状态\r\n\t\t\t\twx.onBluetoothAdapterStateChange(function(res) {\r\n\t\t\t\t\tconsole.log(res.discovering ? \"在搜索。\" : \"未搜索。\");\r\n\t\t\t\t\tconsole.log(res.available ? \"可用。\" : \"不可用。\");\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tfail: function(res) {\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\t/** \r\n\t * 监听发现设备\r\n\t * @param {Object} str\r\n\t * @return {Boolean} 返回值 \r\n\t * @author xxx \r\n\t */\r\n\tonBluetoothDeviceFound(_this, callback) {\r\n\t\tlet that = _this;\r\n\t\twx.onBluetoothDeviceFound(function(res) {\r\n\t\t\tconsole.log('发现设备:', res.devices)\r\n\t\t\tfor (let i = 0; i < res.devices.length; i++) {\r\n\t\t\t\t//检索指定设备\r\n\t\t\t\tif (res.devices[i].name.indexOf('GSD-') != -1) {\r\n\t\t\t\t\tlet connectedDeviceId = res.devices[i].deviceId;\r\n\t\t\t\t\tcallback(true, connectedDeviceId);\r\n\t\t\t\t\t//关闭搜索\r\n\t\t\t\t\tthat.stopFindBLEDevices();\r\n\t\t\t\t\tconsole.log('已找到指定设备:', res.devices[i].deviceId, '设备名：', res.devices[i].name);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback(false, '');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t/** \r\n\t * 停止搜索周边设备\r\n\t * @param {Object} str\r\n\t * @return {Boolean} 返回值 \r\n\t * @author xxx \r\n\t */\r\n\tstopBluetoothDevicesDiscovery(_this, callback) {\r\n\t\tvar that = _this;\r\n\t\twx.stopBluetoothDevicesDiscovery({\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\tconsole.log(\"停止搜索周边设备\" + \"/\" + JSON.stringify(res.errMsg))\r\n\t\t\t\tcallback(true, res)\r\n\t\t\t},\r\n\t\t\tfail: function(res) {\r\n\t\t\t\tconsole.log(\"停止搜索失败：\", res);\r\n\t\t\t\tcallback(false, res)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\t/** \r\n\t * 连接设备\r\n\t * @param {Object} str\r\n\t * @return {Boolean} 返回值 \r\n\t * @author xxx \r\n\t */\r\n\tconnectTO(deviceId, _this, callback) {\r\n\t\tvar that = _this;\r\n\t\tif (typeof deviceId == \"object\") {\r\n\t\t\tdeviceId = deviceId.currentTarget.id;\r\n\t\t\tthat.connectedDeviceId = deviceId;\r\n\t\t}\r\n\t\tif (!deviceId) {\r\n\t\t\tconsole.log(\"设备id错误\")\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tconsole.log(\"连接设备id:\", deviceId);\r\n\t\twx.createBLEConnection({\r\n\t\t\tdeviceId: deviceId.toString(),\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\twx.onBLEConnectionStateChange(function(res) {\r\n\t\t\t\t\t// 该方法回调中可以用于处理连接意外断开等异常情况\r\n\t\t\t\t\tconsole.log(`device ${res.deviceId} state has changed, connected: ${res.connected}`)\r\n\t\t\t\t});\r\n\t\t\t\tcallback(true, res);\r\n\t\t\t\tconsole.log(\"已连接-设备id为%s,连接信息\", that.connectedDeviceId, res);\r\n\t\t\t},\r\n\t\t\tfail: function(res) {\r\n\t\t\t\tcallback(false, res);\r\n\t\t\t\tconsole.log(\"调用失败\", res);\r\n\t\t\t},\r\n\t\t\tcomplete: function() {\r\n\t\t\t\tconsole.log(\"调用结束\");\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t/** \r\n\t * 获取连接设备的service服务\r\n\t * @param {Object} str\r\n\t * @return {Boolean} 返回值 \r\n\t * @author xxx \r\n\t */\r\n\tgetBLEDeviceServices(_this) {\r\n\t\tvar that = _this;\r\n\t\tlet deviceId = that.connectedDeviceId.toString();\r\n\t\tconsole.log(deviceId);\r\n\t\twx.getBLEDeviceServices({\r\n\t\t\t// 这里的 deviceId 需要在上面的 getBluetoothDevices 或 onBluetoothDeviceFound 接口中获取\r\n\t\t\tdeviceId: deviceId,\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\tconsole.log('获取连接设备的service服务成功，设备服务列表:', JSON.stringify(res.services));\r\n\t\t\t\tthat.services = res.services;\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\t//获取连接设备的所有特征值\r\n\tgetBLEDeviceCharacteristics(_this) {\r\n\t\tvar that = _this;\r\n\t\tlet deviceId = that.connectedDeviceId;\r\n\t\tlet serverid = \"00001000-0000-1000-8000-00805F9B34FB\";\r\n\t\twx.getBLEDeviceCharacteristics({\r\n\t\t\t// 这里的 deviceId 需要在上面的 getBluetoothDevices 或 onBluetoothDeviceFound 接口中获取\r\n\t\t\tdeviceId: deviceId,\r\n\t\t\t// 这里的 serviceId 需要在上面的 getBLEDeviceServices 接口中获取\r\n\t\t\t// serviceId: that.services[0].uuid,\r\n\t\t\tserviceId: serverid,\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\t// \t\t\t\tfor (let i = 0; i < res.characteristics.length; i++) {\r\n\t\t\t\t// \t\t\t\t\tif (res.characteristics[i].properties.notify) {\r\n\t\t\t\t// \t\t\t\t\t\tconsole.log(\"111\", that.services[0].uuid);\r\n\t\t\t\t// \t\t\t\t\t\tconsole.log(\"222\", res.characteristics[i].uuid);\r\n\t\t\t\t// \t\t\t\t\t\tthat.notifyServicweId = that.services[0].uuid;\r\n\t\t\t\t// \t\t\t\t\t\tthat.notifyCharacteristicsId = res.characteristics[i].uuid;\r\n\t\t\t\t// \t\t\t\t\t}\r\n\t\t\t\t// \t\t\t\t\tif (res.characteristics[i].properties.write) {\r\n\t\t\t\t// \t\t\t\t\t\tthat.writeServicweId = that.services[0].uuid;\r\n\t\t\t\t// \t\t\t\t\t\tthat.writeCharacteristicsId = res.characteristics[i].uuid;\r\n\t\t\t\t// \t\t\t\t\t} else if (res.characteristics[i].properties.read) {\r\n\t\t\t\t// \t\t\t\t\t\tthat.readServicweId = that.services[0].uuid;\r\n\t\t\t\t// \t\t\t\t\t\tthat.readCharacteristicsId = res.characteristics[i].uuid;\r\n\t\t\t\t// \t\t\t\t\t}\r\n\t\t\t\t// \t\t\t\t}\r\n\t\t\t\tconsole.log('设备服务列表:', res);\r\n\t\t\t},\r\n\t\t\tfail: function() {\r\n\t\t\t\tconsole.log(\"fail\");\r\n\t\t\t},\r\n\t\t\tcomplete: function() {\r\n\t\t\t\tconsole.log(\"complete\");\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t//发送\r\n\tsendBLEValueChange(_this, callback) {\r\n\t\tvar that = _this;\r\n\t\tlet deviceId = that.connectedDeviceId.toString();\r\n\t\t// 这里的回调可以获取到 write 导致的特征值改变\r\n\t\twx.onBLECharacteristicValueChange(function(res) {\r\n\t\t\tlet hex = ab2hex(res.value);\r\n\t\t\tcallback(true, 'success', hex);\r\n\t\t\tconsole.log(\"发送的接收消息,返回值\", hex, res);\r\n\t\t});\r\n\t\tlet senddata = that.inputValue;\r\n\t\tlet buffer = new ArrayBuffer(3)\r\n\t\tlet dataView = new DataView(buffer)\r\n\t\tdataView.setUint8(0, senddata);\r\n\t\tconsole.log('发送的数据', dataView);\r\n\t\tconsole.log('writeServicweId', that.writeServicweId);\r\n\t\tconsole.log('writeCharacteristicsId', that.writeCharacteristicsId);\r\n\t\twx.writeBLECharacteristicValue({\r\n\t\t\t// 这里的 deviceId 需要在上面的 getBluetoothDevices 或 onBluetoothDeviceFound 接口中获取\r\n\t\t\tdeviceId: deviceId,\r\n\t\t\t// 这里的 serviceId 需要在上面的 getBLEDeviceServices 接口中获取\r\n\t\t\tserviceId: that.writeServicweId,\r\n\t\t\t// 这里的 characteristicId 需要在上面的 getBLEDeviceCharacteristics 接口中获取\r\n\t\t\tcharacteristicId: that.writeCharacteristicsId,\r\n\t\t\t// 这里的value是ArrayBuffer类型\r\n\t\t\tvalue: buffer,\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\tcallback(true, 'success', '');\r\n\t\t\t\tconsole.log('发送成功：', res)\r\n\t\t\t},\r\n\t\t\tfail: function(res) {\r\n\t\t\t\tcallback(false, '', res);\r\n\t\t\t\tconsole.log('发送成功：', res);\r\n\t\t\t}\r\n\t\t})\r\n\t\t// \t\twx.request({\r\n\t\t// \t\t\turl: '../getEncrypt',\r\n\t\t// \t\t\tsuccess: function(data) {\r\n\t\t// \t\t\t\tvar arr = data.data.data.split(\",\");\r\n\t\t// \t\t\t\tconsole.log(arr);\r\n\t\t// \t\t\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t// \t\t\t\t\tdataView.setInt8(i, arr[i]);\r\n\t\t// \t\t\t\t}\r\n\t\t// \t\t\t\t\r\n\t\t// \t\t\t}\r\n\t\t// \t\t})\r\n\t}\r\n\t//启用低功耗蓝牙设备特征值变化时的 notify 功能\r\n\tnotifyBLEValueChange(_this, callback) {\r\n\t\tvar that = _this;\r\n\t\tlet deviceId = that.connectedDeviceId.toString();\r\n\t\t//var notifyServicweId = that.data.notifyServicweId.toUpperCase();\r\n\t\t//var notifyCharacteristicsId = that.data.notifyCharacteristicsId.toUpperCase();\r\n\t\tconsole.log(\"111\", deviceId);\r\n\t\tconsole.log(\"111\", that.notifyServicweId);\r\n\t\tconsole.log(\"222\", that.notifyCharacteristicsId);\r\n\t\twx.notifyBLECharacteristicValueChange({\r\n\t\t\tstate: true, // 启用 notify 功能\r\n\t\t\t// 这里的 deviceId 需要在上面的 getBluetoothDevices 或 onBluetoothDeviceFound 接口中获取\r\n\t\t\tdeviceId: deviceId,\r\n\t\t\t// 这里的 serviceId 需要在上面的 getBLEDeviceServices 接口中获取\r\n\t\t\tserviceId: that.notifyServicweId,\r\n\t\t\t// 这里的 characteristicId 需要在上面的 getBLEDeviceCharacteristics 接口中获取\r\n\t\t\tcharacteristicId: that.notifyCharacteristicsId,\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\tconsole.log('启用蓝牙设备特征值变化notify 功能成功', res);\r\n\t\t\t\tcallback(true, res);\r\n\t\t\t},\r\n\t\t\tfail: function(res) {\r\n\t\t\t\tcallback(false, res);\r\n\t\t\t\tconsole.log('启用蓝牙设备特征值变化notify 功能失败', res);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\t//接收消息\r\n\tgetBLEValueChange(_this) {\r\n\t\tvar that = _this;\r\n\t\tlet deviceId = that.connectedDeviceId.toString();\r\n\t\t// 必须在这里的回调才能获取\r\n\t\twx.onBLECharacteristicValueChange(function(characteristic) {\r\n\t\t\tlet hex = ab2hex(characteristic.value);\r\n\t\t\tconsole.log(\"接收消息：,返回值\", hex, characteristic);\r\n\t\t})\r\n\t\tconsole.log(\"readServicweId：\", that.readServicweId);\r\n\t\tconsole.log(\"readCharacteristicsId：\", that.readCharacteristicsId);\r\n\t\twx.readBLECharacteristicValue({\r\n\t\t\t// 这里的 deviceId 需要在上面的 getBluetoothDevices 或 onBluetoothDeviceFound 接口中获取\r\n\t\t\tdeviceId: deviceId,\r\n\t\t\t// 这里的 serviceId 需要在上面的 getBLEDeviceServices 接口中获取\r\n\t\t\tserviceId: that.readServicweId,\r\n\t\t\t// 这里的 characteristicId 需要在上面的 getBLEDeviceCharacteristics 接口中获取\r\n\t\t\tcharacteristicId: that.readCharacteristicsId,\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\tconsole.log('可读特征值:', res);\r\n\t\t\t},\r\n\t\t\tfail: function(res) {\r\n\t\t\t\tconsole.log('读取可读特征值失败', res);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\t//断开设备连接\r\n\tcloseBLEConnection(_this) {\r\n\t\tvar that = _this;\r\n\t\tlet deviceId = ''\r\n\t\tif (that.connectedDeviceId.length > 0) {\r\n\t\t\tdeviceId = that.connectedDeviceId.toString();\r\n\t\t} else {\r\n\t\t\tconsole.log(\"没有connectedDeviceId\")\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!that.connectedDeviceId) {\r\n\t\t\tconsole.log(\"没有连接设备，断开失败\", that.connectedDeviceId)\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\twx.closeBLEConnection({\r\n\t\t\tdeviceId: deviceId,\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\tthat.connectedDeviceId = \"\";\r\n\t\t\t\tconsole.log(\"断开成功\", res)\r\n\t\t\t},\r\n\t\t\tfail: function(res) {\r\n\t\t\t\tconsole.log(\"断开失败\", res)\r\n\t\t\t}\r\n\t\t})\r\n\t\twx.closeBluetoothAdapter({\r\n\t\t\tsuccess(res) {\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n// ArrayBuffer转为16进制数\r\nfunction ab2hex(buffer) {\r\n\tvar hexArr = Array.prototype.map.call(\r\n\t\tnew Uint8Array(buffer),\r\n\t\tfunction(bit) {\r\n\t\t\treturn ('00' + bit.toString(16)).slice(-2)\r\n\t\t}\r\n\t)\r\n\treturn hexArr;\r\n}\r\n// 16进制数转ASCLL码\r\nfunction hexCharCodeToStr(hexCharCodeStr) {\r\n\tvar trimedStr = hexCharCodeStr.trim();\r\n\tvar rawStr = trimedStr.substr(0, 2).toLowerCase() === \"0x\" ? trimedStr.substr(2) : trimedStr;\r\n\tvar len = rawStr.length;\r\n\tvar curCharCode;\r\n\tvar resultStr = [];\r\n\tfor (var i = 0; i < len; i = i + 2) {\r\n\t\tcurCharCode = parseInt(rawStr.substr(i, 2), 16);\r\n\t\tresultStr.push(String.fromCharCode(curCharCode));\r\n\t}\r\n\treturn resultStr.join(\"\");\r\n}\r\nexport default new bluetooth()\r\n\n\n\n// WEBPACK FOOTER //\n// ./I:/HBX/icoo/common/util/bluetooth.js","let childMixin = {\r\n\tdata: function() {\r\n\t\treturn {\r\n\t\t\tpopupShowState: {\r\n\t\t\t\ttop: false,\r\n\t\t\t\tmiddle: false,\r\n\t\t\t\tbottom: false\r\n\t\t\t},\r\n\t\t\tpopupShowMask: false,\r\n\t\t\tactivePop: 'middle'\r\n\t\t}\r\n\t},\r\n\tonBackPress: function() {\r\n\t\tif (this.popupShowMask) {\r\n\t\t\tthis.popupShowMask = false\r\n\t\t\tthis.hide()\r\n\t\t\treturn true\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tpopupShow: function(evt) {\r\n\t\t\tvar pos = evt;\r\n\t\t\tconsole.log(pos)\r\n\t\t\tswitch (pos) {\r\n\t\t\t\tcase 'top':\r\n\t\t\t\t\tthis.activePop = 'top'\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'bottom':\r\n\t\t\t\t\tthis.activePop = 'bottom'\r\n\t\t\t\t\tbreak\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.activePop = 'middle'\r\n\t\t\t}\r\n\t\t\tthis.popupShowMask = true\r\n\t\t\tthis.popupShowState[this.activePop] = true\r\n\t\t},\r\n\t\tpopupHide: function() {\r\n\t\t\tthis.popupShowMask = false\r\n\t\t\tthis.popupShowState[this.activePop] = false\r\n\t\t}\r\n\t}\r\n}\r\nexport {\r\n\tchildMixin\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./I:/HBX/icoo/common/mixins.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('view', {\n    staticClass: \"page\"\n  }, [_c('view', {\n    staticClass: \"page-body\"\n  }, [_c('view', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.popupShowMask),\n      expression: \"popupShowMask\"\n    }],\n    staticClass: \"mask\",\n    attrs: {\n      \"eventid\": 'A1v-0'\n    },\n    on: {\n      \"tap\": _vm.popupHide\n    }\n  }), _c('view', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.popupShowState.top),\n      expression: \"popupShowState.top\"\n    }],\n    staticClass: \"popup popup-top\"\n  }, [_c('text', [_vm._v(\"顶部 popup\")])]), _c('view', {\n    staticClass: \"page-body-text\"\n  }, [_c('text', {\n    staticClass: \"status\"\n  }, [_vm._v(\"适配器状态：\" + _vm._s(_vm.status))]), _c('text', {\n    staticClass: \"sousuo\"\n  }, [_vm._v(\"是否搜索：\" + _vm._s(_vm.sousuo))]), _c('text', {\n    staticClass: \"msg\"\n  }, [_vm._v(\"消息：\" + _vm._s(_vm.msg) + \" \")]), _c('text', {\n    staticClass: \"msg1\"\n  }, [_vm._v(\"消息：\" + _vm._s(_vm.msg1))])]), _c('view', {\n    staticClass: \"section\"\n  }, [_c('text', {\n    staticClass: \"status\"\n  }, [_vm._v(\"接收到消息：\" + _vm._s(_vm.jieshou))])]), _c('input', {\n    directives: [{\n      name: \"model\",\n      rawName: \"v-model\",\n      value: (_vm.inputValue),\n      expression: \"inputValue\"\n    }],\n    attrs: {\n      \"type\": \"text\",\n      \"eventid\": '16O-1'\n    },\n    domProps: {\n      \"value\": (_vm.inputValue)\n    },\n    on: {\n      \"input\": function($event) {\n        if ($event.target.composing) { return; }\n        _vm.inputValue = $event.target.value\n      }\n    }\n  }), _c('view', {\n    staticClass: \"btn-row\"\n  }, [_c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 'NaA-2'\n    },\n    on: {\n      \"tap\": _vm.initOpen\n    }\n  }, [_vm._v(\"初始化蓝牙\")]), _c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 'PY9-3'\n    },\n    on: {\n      \"tap\": _vm.findBLEDevices\n    }\n  }, [_vm._v(\"搜索周边设备\")]), _c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 'RQV-4'\n    },\n    on: {\n      \"tap\": _vm.getBluetoothDevices\n    }\n  }, [_vm._v(\"获取所有设备\")]), _c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 'rTh-5'\n    },\n    on: {\n      \"tap\": _vm.onBluetoothDeviceFound\n    }\n  }, [_vm._v(\"监听发现设备\")]), _c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 'ylx-6'\n    },\n    on: {\n      \"tap\": _vm.getBLEDeviceServices\n    }\n  }, [_vm._v(\"获取连接设备server\")]), _c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 'GXe-7'\n    },\n    on: {\n      \"tap\": _vm.getBLEDeviceCharacteristics\n    }\n  }, [_vm._v(\"获取连接设备所有特征\")]), _c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 'XSc-8'\n    },\n    on: {\n      \"tap\": _vm.sendBLEValueChange\n    }\n  }, [_vm._v(\"发送数据\")]), _c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 'uJw-9'\n    },\n    on: {\n      \"tap\": _vm.notifyBLEValueChange\n    }\n  }, [_vm._v(\"启用设备特征值变化时的notify\")]), _c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 'N1n-10'\n    },\n    on: {\n      \"tap\": _vm.getBLEValueChange\n    }\n  }, [_vm._v(\"接收消息\")]), _c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 'AL5-11'\n    },\n    on: {\n      \"tap\": _vm.getBluetoothState\n    }\n  }, [_vm._v(\"本机蓝牙适配器状态\")]), _c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 't4k-12'\n    },\n    on: {\n      \"tap\": _vm.stopFindBLEDevices\n    }\n  }, [_vm._v(\"停止搜索周边设备\")]), _c('button', {\n    staticClass: \"button\",\n    attrs: {\n      \"type\": \"primary\",\n      \"eventid\": 'WsK-13'\n    },\n    on: {\n      \"tap\": _vm.closeBLEDevices\n    }\n  }, [_vm._v(\"断开蓝牙连接\")])], 1)]), _c('view', {\n    staticClass: \"venues_list\"\n  }, _vm._l((_vm.devices), function(item, index) {\n    return _c('block', {\n      key: index\n    }, [_c('view', {\n      staticClass: \"venues_item\"\n    }, [_c('text', {\n      staticClass: \"status\"\n    }, [_vm._v(\"设备名称:\" + _vm._s(item.name))]), _c('text', {\n      staticClass: \"status\"\n    }, [_vm._v(\"设备ID:\" + _vm._s(item.deviceId))]), _c('text', {\n      staticClass: \"status\"\n    }, [_vm._v(\"连接状态:\" + _vm._s(_vm.connectedDeviceId == item.deviceId ? \"已连接\" : \"未连接\"))]), _c('view', {\n      staticClass: \"section\"\n    }), _c('view', {\n      staticClass: \"section\"\n    }, [_c('button', {\n      staticClass: \"button\",\n      attrs: {\n        \"type\": \"warn\",\n        \"id\": item.deviceId,\n        \"eventid\": 'n2C-14-' + index\n      },\n      on: {\n        \"tap\": function($event) {\n          _vm.connectTO($event)\n        }\n      }\n    }, [_vm._v(\"连接\")])], 1)])])\n  }))])\n}\nvar staticRenderFns = []\nrender._withStripped = true\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\nif (module.hot) {\n  module.hot.accept()\n  if (module.hot.data) {\n     require(\"vue-hot-reload-api\").rerender(\"data-v-36b9c0cb\", esExports)\n  }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/mpvue-loader/lib/template-compiler?{\"id\":\"data-v-36b9c0cb\",\"hasScoped\":true,\"preserveWhitespace\":false}!./lib/preprocessor-loader.js?{\"type\":\"html\",\"context\":{\"MP-WEIXIN\":true}}!./lib/mpvue-loader/lib/selector.js?type=template&index=0!I:/HBX/icoo/pages/API/get-bluetooth-tool/get-bluetooth-tool.vue\n// module id = 53\n// module chunks = 3"],"sourceRoot":""}