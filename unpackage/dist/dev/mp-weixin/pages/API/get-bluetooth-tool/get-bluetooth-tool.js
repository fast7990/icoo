require("../../../common/manifest.js");
require("../../../common/vendor.js");
global.webpackJsonp([3],{47:function(e,t,o){"use strict";var n=s(o(1)),i=s(o(48));function s(e){return e&&e.__esModule?e:{default:e}}Page((0,n.default)(i.default))},48:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(50),i=o.n(n),s=o(53),c=!1;var a=function(e){c||o(49)},l=o(0)(i.a,s.a,a,"data-v-36b9c0cb",null);l.options.__file="..\\..\\..\\..\\HBX\\icoo\\pages\\API\\get-bluetooth-tool\\get-bluetooth-tool.vue",l.esModule&&Object.keys(l.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),l.options.functional&&console.error("[vue-loader] get-bluetooth-tool.vue: functional components are not supported with templates, they should use render functions."),t.default=l.exports},49:function(e,t){},50:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=o(51),s=(n=i)&&n.__esModule?n:{default:n},c=o(52);t.default={mixins:[c.childMixin],data:function(){return{status:"",sousuo:"",msg:"",msg1:"",connectedDeviceId:"",services:"00001000-0000-1000-8000-00805f9b34fb",characteristics:"",writeServicweId:"00001000-0000-1000-8000-00805f9b34fb",writeCharacteristicsId:"00001001-0000-1000-8000-00805f9b34fb",readServicweId:"00001000-0000-1000-8000-00805f9b34fb",readCharacteristicsId:"00001005-0000-1000-8000-00805f9b34fb",notifyServicweId:"00001000-0000-1000-8000-00805f9b34fb",notifyCharacteristicsId:"00001002-0000-1000-8000-00805f9b34fb",inputValue:"85",devices:[],characteristics1:""}},onLoad:function(){wx.openBluetoothAdapter?wx.openBluetoothAdapter():wx.showModal({title:"提示",content:"当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。"})},methods:{connectTO:function(e){s.default.connectTO(e,this,function(){})},initOpen:function(){s.default.openBluetoothAdapter(this,function(e,t){return e||wx.showModal({title:"蓝牙未打开",content:"请打开蓝牙后重试连接"}),e})},closeBLEDevices:function(){s.default.closeBLEConnection(this)},findBLEDevices:function(){s.default.startBluetoothDevicesDiscovery(this,function(e,t){})},stopFindBLEDevices:function(){s.default.stopBluetoothDevicesDiscovery(this,function(e,t){})},getBluetoothDevices:function(){s.default.getBluetoothDevices(this),s.default.onBluetoothDeviceFound(this)},sendBLEValueChange:function(){s.default.sendBLEValueChange(this,function(){})},notifyBLEValueChange:function(){s.default.notifyBLEValueChange(this,function(){})},getBLEValueChange:function(){s.default.getBLEValueChange(this)},getBluetoothState:function(){s.default.getBluetoothAdapterState(this)},getBLEDeviceServices:function(){s.default.getBLEDeviceServices(this)},getBLEDeviceCharacteristics:function(){s.default.getBLEDeviceCharacteristics(this)}}}},51:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"openBluetoothAdapter",value:function(e,t){var o=e;wx.openBluetoothAdapter({success:function(e){console.log("初始化蓝牙适配器成功！"+JSON.stringify(e)),wx.onBluetoothAdapterStateChange(function(e){console.log(e.discovering?"在搜索。":"未搜索。"),console.log(e.available?"可用。":"不可用。")}),console.log(o.msg),t(!0,e)},fail:function(e){console.log(e),t(!1,e)}})}},{key:"getBluetoothAdapterState",value:function(e){var t=e;wx.getBluetoothAdapterState({success:function(e){t.msg="本机蓝牙适配器状态/"+JSON.stringify(e.errMsg),console.log(e.discovering?"在搜索。":"未搜索。"),console.log(e.available?"可用。":"不可用。"),wx.onBluetoothAdapterStateChange(function(e){console.log(e.discovering?"在搜索。":"未搜索。"),console.log(e.available?"可用。":"不可用。")})},fail:function(e){console.log(e)}})}},{key:"startBluetoothDevicesDiscovery",value:function(e,t){var o=e;o.devices=[],wx.startBluetoothDevicesDiscovery({success:function(e){o.msg="搜索设备"+JSON.stringify(e),wx.onBluetoothAdapterStateChange(function(e){console.log(e.discovering?"在搜索。":"未搜索。"),console.log(e.available?"可用。":"不可用。")}),console.log("开始搜索设备成功:",e),t(!0,e)},fail:function(e){t(!1,e),console.log("搜索失败：",e)}})}},{key:"getBluetoothDevices",value:function(e){var t=e;t.devices=[];t.connectedDeviceId;wx.getBluetoothDevices({success:function(e){wx.getConnectedBluetoothDevices({success:function(e){console.log("发现设备状态",JSON.stringify(e)),e.devices[0]&&console.log("已连接设备")},fail:function(e){console.log("获取失败",e)}});for(var o=[],n=0;n<e.devices.length;n++)"未知设备"!=e.devices[n].name&&o.push(e.devices[n]);t.devices=o,console.log("获取所有已发现的设备",e.devices),wx.onBluetoothAdapterStateChange(function(e){console.log(e.discovering?"在搜索。":"未搜索。"),console.log(e.available?"可用。":"不可用。")})},fail:function(e){console.log(e)}})}},{key:"onBluetoothDeviceFound",value:function(e,t){var o=e;wx.onBluetoothDeviceFound(function(e){console.log("发现设备:",e.devices);for(var n=0;n<e.devices.length;n++)if(-1!=e.devices[n].name.indexOf("GSD-")){var i=e.devices[n].deviceId;t(!0,i),o.stopFindBLEDevices(),console.log("已找到指定设备:",e.devices[n].deviceId,"设备名：",e.devices[n].name)}else t(!1,"")})}},{key:"stopBluetoothDevicesDiscovery",value:function(e,t){wx.stopBluetoothDevicesDiscovery({success:function(e){console.log("停止搜索周边设备/"+JSON.stringify(e.errMsg)),t(!0,e)},fail:function(e){console.log("停止搜索失败：",e),t(!1,e)}})}},{key:"connectTO",value:function(e,t,o){var i=t;if("object"==(void 0===e?"undefined":n(e))&&(e=e.currentTarget.id,i.connectedDeviceId=e),!e)return console.log("设备id错误"),!1;console.log("连接设备id:",e),wx.createBLEConnection({deviceId:e.toString(),success:function(e){wx.onBLEConnectionStateChange(function(e){console.log("device "+e.deviceId+" state has changed, connected: "+e.connected)}),o(!0,e),console.log("已连接-设备id为%s,连接信息",i.connectedDeviceId,e)},fail:function(e){o(!1,e),console.log("调用失败",e)},complete:function(){console.log("调用结束")}})}},{key:"getBLEDeviceServices",value:function(e){var t=e,o=t.connectedDeviceId.toString();console.log(o),wx.getBLEDeviceServices({deviceId:o,success:function(e){console.log("获取连接设备的service服务成功，设备服务列表:",JSON.stringify(e.services)),t.services=e.services}})}},{key:"getBLEDeviceCharacteristics",value:function(e){var t=e.connectedDeviceId;wx.getBLEDeviceCharacteristics({deviceId:t,serviceId:"00001000-0000-1000-8000-00805F9B34FB",success:function(e){console.log("设备服务列表:",e)},fail:function(){console.log("fail")},complete:function(){console.log("complete")}})}},{key:"sendBLEValueChange",value:function(e,t){var o=e,n=o.connectedDeviceId.toString();wx.onBLECharacteristicValueChange(function(e){var o=c(e.value);t(!0,"success",o),console.log("发送的接收消息,返回值",o,e)});var i=o.inputValue,s=new ArrayBuffer(3),a=new DataView(s);a.setUint8(0,i),console.log("发送的数据",a),console.log("writeServicweId",o.writeServicweId),console.log("writeCharacteristicsId",o.writeCharacteristicsId),wx.writeBLECharacteristicValue({deviceId:n,serviceId:o.writeServicweId,characteristicId:o.writeCharacteristicsId,value:s,success:function(e){t(!0,"success",""),console.log("发送成功：",e)},fail:function(e){t(!1,"",e),console.log("发送成功：",e)}})}},{key:"notifyBLEValueChange",value:function(e,t){var o=e,n=o.connectedDeviceId.toString();console.log("111",n),console.log("111",o.notifyServicweId),console.log("222",o.notifyCharacteristicsId),wx.notifyBLECharacteristicValueChange({state:!0,deviceId:n,serviceId:o.notifyServicweId,characteristicId:o.notifyCharacteristicsId,success:function(e){console.log("启用蓝牙设备特征值变化notify 功能成功",e),t(!0,e)},fail:function(e){t(!1,e),console.log("启用蓝牙设备特征值变化notify 功能失败",e)}})}},{key:"getBLEValueChange",value:function(e){var t=e,o=t.connectedDeviceId.toString();wx.onBLECharacteristicValueChange(function(e){var t=c(e.value);console.log("接收消息：,返回值",t,e)}),console.log("readServicweId：",t.readServicweId),console.log("readCharacteristicsId：",t.readCharacteristicsId),wx.readBLECharacteristicValue({deviceId:o,serviceId:t.readServicweId,characteristicId:t.readCharacteristicsId,success:function(e){console.log("可读特征值:",e)},fail:function(e){console.log("读取可读特征值失败",e)}})}},{key:"closeBLEConnection",value:function(e){var t=e,o="";if(t.connectedDeviceId.length>0){if(o=t.connectedDeviceId.toString(),!t.connectedDeviceId)return console.log("没有连接设备，断开失败",t.connectedDeviceId),!1;wx.closeBLEConnection({deviceId:o,success:function(e){t.connectedDeviceId="",console.log("断开成功",e)},fail:function(e){console.log("断开失败",e)}}),wx.closeBluetoothAdapter({success:function(e){console.log(e)}})}else console.log("没有connectedDeviceId")}}]),e}();function c(e){return Array.prototype.map.call(new Uint8Array(e),function(e){return("00"+e.toString(16)).slice(-2)})}t.default=new s},52:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={data:function(){return{popupShowState:{top:!1,middle:!1,bottom:!1},popupShowMask:!1,activePop:"middle"}},onBackPress:function(){if(this.popupShowMask)return this.popupShowMask=!1,this.hide(),!0},methods:{popupShow:function(e){var t=e;switch(console.log(t),t){case"top":this.activePop="top";break;case"bottom":this.activePop="bottom";break;default:this.activePop="middle"}this.popupShowMask=!0,this.popupShowState[this.activePop]=!0},popupHide:function(){this.popupShowMask=!1,this.popupShowState[this.activePop]=!1}}};t.childMixin=n},53:function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("view",{staticClass:"page"},[o("view",{staticClass:"page-body"},[o("view",{directives:[{name:"show",rawName:"v-show",value:e.popupShowMask,expression:"popupShowMask"}],staticClass:"mask",attrs:{eventid:"rih-0"},on:{tap:e.popupHide}}),o("view",{directives:[{name:"show",rawName:"v-show",value:e.popupShowState.top,expression:"popupShowState.top"}],staticClass:"popup popup-top"},[o("text",[e._v("顶部 popup")])]),o("view",{staticClass:"page-body-text"},[o("text",{staticClass:"status"},[e._v("适配器状态："+e._s(e.status))]),o("text",{staticClass:"sousuo"},[e._v("是否搜索："+e._s(e.sousuo))]),o("text",{staticClass:"msg"},[e._v("消息："+e._s(e.msg)+" ")]),o("text",{staticClass:"msg1"},[e._v("消息："+e._s(e.msg1))])]),o("view",{staticClass:"section"},[o("text",{staticClass:"status"},[e._v("接收到消息："+e._s(e.jieshou))])]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],attrs:{type:"text",eventid:"yaI-1"},domProps:{value:e.inputValue},on:{input:function(t){t.target.composing||(e.inputValue=t.target.value)}}}),o("view",{staticClass:"btn-row"},[o("button",{staticClass:"button",attrs:{type:"primary",eventid:"Q8o-2"},on:{tap:e.initOpen}},[e._v("初始化蓝牙")]),o("button",{staticClass:"button",attrs:{type:"primary",eventid:"ERp-3"},on:{tap:e.findBLEDevices}},[e._v("搜索周边设备")]),o("button",{staticClass:"button",attrs:{type:"primary",eventid:"5Ur-4"},on:{tap:e.getBluetoothDevices}},[e._v("获取所有设备")]),o("button",{staticClass:"button",attrs:{type:"primary",eventid:"9gs-5"},on:{tap:e.onBluetoothDeviceFound}},[e._v("监听发现设备")]),o("button",{staticClass:"button",attrs:{type:"primary",eventid:"6G8-6"},on:{tap:e.getBLEDeviceServices}},[e._v("获取连接设备server")]),o("button",{staticClass:"button",attrs:{type:"primary",eventid:"Uzh-7"},on:{tap:e.getBLEDeviceCharacteristics}},[e._v("获取连接设备所有特征")]),o("button",{staticClass:"button",attrs:{type:"primary",eventid:"sI4-8"},on:{tap:e.sendBLEValueChange}},[e._v("发送数据")]),o("button",{staticClass:"button",attrs:{type:"primary",eventid:"c6o-9"},on:{tap:e.notifyBLEValueChange}},[e._v("启用设备特征值变化时的notify")]),o("button",{staticClass:"button",attrs:{type:"primary",eventid:"RU9-10"},on:{tap:e.getBLEValueChange}},[e._v("接收消息")]),o("button",{staticClass:"button",attrs:{type:"primary",eventid:"YAq-11"},on:{tap:e.getBluetoothState}},[e._v("本机蓝牙适配器状态")]),o("button",{staticClass:"button",attrs:{type:"primary",eventid:"Z5k-12"},on:{tap:e.stopFindBLEDevices}},[e._v("停止搜索周边设备")]),o("button",{staticClass:"button",attrs:{type:"primary",eventid:"vZ5-13"},on:{tap:e.closeBLEDevices}},[e._v("断开蓝牙连接")])],1)]),o("view",{staticClass:"venues_list"},e._l(e.devices,function(t,n){return o("block",{key:n},[o("view",{staticClass:"venues_item"},[o("text",{staticClass:"status"},[e._v("设备名称:"+e._s(t.name))]),o("text",{staticClass:"status"},[e._v("设备ID:"+e._s(t.deviceId))]),o("text",{staticClass:"status"},[e._v("连接状态:"+e._s(e.connectedDeviceId==t.deviceId?"已连接":"未连接"))]),o("view",{staticClass:"section"}),o("view",{staticClass:"section"},[o("button",{staticClass:"button",attrs:{type:"warn",id:t.deviceId,eventid:"djG-14-"+n},on:{tap:function(t){e.connectTO(t)}}},[e._v("连接")])],1)])])}))])};n._withStripped=!0;var i={render:n,staticRenderFns:[]};t.a=i}},[47]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/API/get-bluetooth-tool/get-bluetooth-tool.js.map