require("../../../common/manifest.js");
require("../../../common/vendor.js");
global.webpackJsonp([22],{18:function(e,t,o){"use strict";var s=a(o(1)),n=a(o(19));function a(e){return e&&e.__esModule?e:{default:e}}Page((0,s.default)(n.default))},19:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(21),n=o.n(s),a=o(22),i=!1;var r=function(e){i||o(20)},c=o(0)(n.a,a.a,r,"data-v-0a1f1ad1",null);c.options.__file="..\\..\\..\\..\\HBX\\icoo\\pages\\tabBar\\login\\login.vue",c.esModule&&Object.keys(c.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),c.options.functional&&console.error("[vue-loader] login.vue: functional components are not supported with templates, they should use render functions."),t.default=c.exports},20:function(e,t){},21:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},n=o(3);t.default={data:function(){return{canIUse:wx.canIUse("button.open-type.getUserInfo"),show_status:!1}},computed:s({},(0,n.mapState)({$globalData:"globalData"})),onLoad:function(e){console.log("login",e),this.$store.commit("set_shareFriendCode",e.shareFriendCode);var t=this.$store.state.homeTimer;null!=t&&(clearInterval(t),this.$store.commit("set_homeTimer",null));var o=this;wx.getSetting({success:function(e){console.log("wxseting",e),e.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(e){console.log("已授权获取用户信息",e),o.$store.commit("set_globalData",{encryptedData:e.encryptedData,iv:e.iv,userInfo:e.userInfo}),o.getlogin()}}):o.show_status=!0}})},methods:s({},(0,n.mapMutations)(["set_userCode","set_invitationCode","set_token","set_score","set_headpicUrl","set_nickName","set_BLEDriverData"]),{getlogin:function(){var e=this;wx.login({success:function(t){var o=t.code;e.queryUserCode(o),console.log("code码",o)},fail:function(e){console.log("err",e)}})},queryUserCode:function(t){var o=this;wx.request({url:this.$globalData.urlPath+"app/wx/xcxHasUserLogin",data:{code:t},method:"GET",header:{"content-type":"application/json"},success:function(t){if(console.log(t),1==t.data.status){var s=t.data.data;o.loginHome(s)}else e.showToast({icon:"none",title:"登录失败请重新验证",success:function(){e.navigateTo({url:"../register/register"})}})},fail:function(e){console.log("err",e)}})},loginHome:function(t){this.set_userCode(t.userCode),this.set_invitationCode(t.invitationCode),this.set_token(t.token),this.set_score(t.score),this.set_headpicUrl(t.headpicUrl),this.set_nickName(t.nickName),this.set_BLEDriverData(""),setTimeout(function(){e.switchTab({url:"../home/home"})},1500)},bindGetUserInfo:function(e){console.log(e);e.detail?this.getlogin():wx.showModal({title:"警告",content:"您点击了拒绝授权，将无法进入小程序，请授权之后再进入!!!",showCancel:!1,confirmText:"返回授权",success:function(e){e.confirm&&console.log("用户点击了“返回授权”")}})},queryUsreInfo:function(){var e=this;wx.request({url:this.$globalData.urlPath+"hstc_interface/queryByOpenid",data:{openid:this.$globalData.openid},header:{"content-type":"application/json"},success:function(t){console.log(t.data),e.$store.commit("set_globalData",{userInfo:t.data})}})}})}}).call(t,o(2).default)},22:function(e,t,o){"use strict";var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.canIUse?o("view",[e._m(0),o("view",{directives:[{name:"show",rawName:"v-show",value:!e.show_status,expression:"!show_status"}],staticClass:"page-section",staticStyle:{"text-align":"center","margin-top":"50upx"}},[o("text",{staticStyle:{"font-size":"36upx"}},[e._v("爱氪生活")])]),o("view",{directives:[{name:"show",rawName:"v-show",value:e.show_status,expression:"show_status"}],staticClass:"page-section grant"},[e._m(1),o("button",{staticClass:"bottom",attrs:{type:"primary","open-type":"getUserInfo",lang:"zh_CN",eventid:"duM-0"},on:{getuserinfo:e.bindGetUserInfo}},[e._v("\n\t\t\t授权登录\n\t\t")])],1)]):e._e()};s._withStripped=!0;var n={render:s,staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("view",{staticClass:"header"},[t("image",{attrs:{src:"../../../static/img/login/icoologo.png"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("view",{staticClass:"content"},[t("view",[this._v("申请获取以下权限")]),t("text",[this._v("获得你的公开信息(昵称，头像等)")])])}]};t.a=n}},[18]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/tabBar/login/login.js.map