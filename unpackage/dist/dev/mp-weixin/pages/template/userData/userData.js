require("../../../common/manifest.js");
require("../../../common/vendor.js");
global.webpackJsonp([10],{78:function(t,e,a){"use strict";var s=n(a(1)),i=n(a(79));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,s.default)(i.default))},79:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(81),i=a.n(s),n=a(82),o=!1;var r=function(t){o||a(80)},c=a(0)(i.a,n.a,r,"data-v-3d0b6d59",null);c.options.__file="..\\..\\..\\..\\HBX\\icoo\\pages\\template\\userData\\userData.vue",c.esModule&&Object.keys(c.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),c.options.functional&&console.error("[vue-loader] userData.vue: functional components are not supported with templates, they should use render functions."),e.default=c.exports},80:function(t,e){},81:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{sex_index:2,sex_array:["女","男","-"],date:this.getDate({format:!0}),user_data:"",headerImageSrc:"",baseurl:"https://www.icoo.tech",util_list:[{name:"昵称",info:"未设置",value:"",target:"nickName"},{name:"性别",info:"未设置",value:"",target:"sex"},{name:"出生日期",info:"未设置",value:"",target:"birthday"},{name:"身高",info:"未设置",value:"",target:"height"},{name:"体重",info:"未设置",value:"",target:"weight"}]}},computed:{startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate("end")}},onShow:function(){this.initData();var t=this.$store.state.userData;Array.isArray(t)&&this.setListData(t[0],t[1])},methods:{initData:function(){var t=this;this.$api.userPage({userCode:this.$store.state.userCode,token:this.$store.state.token},function(e){console.log(e),1==e.data.status&&(t.util_list[0].info=e.data.data.nickName?e.data.data.nickName:"-",t.sex_index=e.data.data.sex?e.data.data.sex:2,t.headerImageSrc=e.data.data.headpicUrl.indexOf("http")>-1?e.data.data.headpicUrl:t.baseurl+e.data.data.headpicUrl,t.date=e.data.data.birthday?e.data.data.birthday:"-",t.util_list[3].info=e.data.data.height?e.data.data.height:"-",t.util_list[4].info=e.data.data.weight?e.data.data.weight:"-")},function(t){console.log(t)})},updateUserInfo:function(e,a){if("sex"!=a||""!=e)if("birthday"!=a||""!=e){var s={userCode:this.$store.state.userCode,token:this.$store.state.token};s[a]=e,console.log(s),this.$api.userInfo(s,function(t){console.log(t)},function(t){console.log(t)})}else t.showToast({title:"生日不能为空",icon:"none"});else t.showToast({title:"性别不能为空",icon:"none"})},setListData:function(t,e){this.util_list.forEach(function(a,s){a.target==t&&(a.info=e,a.value=e)})},bindPickerChange:function(t){console.log("picker发送选择改变，携带值为",t.target.value),this.sex_index=t.target.value,this.util_list[1].value=this.sex_array[this.sex_index],this.updateUserInfo(this.sex_index,"sex")},bindDateChange:function(t){this.date=t.target.value,this.updateUserInfo(this.date,"birthday")},openTag:function(t){"sex"!=t.target&&"birthday"!=t.target&&this.open(t.target)},open:function(t){switch(t){case"nickName":this.target("datachecker",t,"template");break;case"sex":this.target("mpvuePicker",t,"components");break;case"height":case"weight":case"phone":this.target("datachecker",t,"template")}},getDate:function(t){var e=new Date,a=e.getFullYear(),s=e.getMonth()+1,i=e.getDate();return"start"===t?a-=60:"end"===t&&(a+=2),a+"-"+(s=s>9?s:"0"+s)+"-"+(i=i>9?i:"0"+i)},target:function(e,a,s){t.navigateTo({url:"../../"+s+"/"+e+"/"+e+"?type="+a,success:function(t){console.log(t)},fail:function(t){console.log(t)}})},chooseImage:function(){var e=this;t.chooseImage({count:1,sizeType:["compressed"],sourceType:["album"],success:function(a){console.log("chooseImage success, temp path is",a.tempFilePaths[0]);var s=a.tempFilePaths[0];t.uploadFile({url:"https://www.icoo.tech/app/member/uploadimg",formData:{userCode:e.$store.state.userCode,token:e.$store.state.token},filePath:s,name:"file",success:function(a){console.log("uploadImage success, res is:",JSON.parse(a.data));var i=JSON.parse(a.data);t.showToast({title:"上传成功",icon:"success",duration:1e3}),e.headerImageSrc=s,console.log(i.data),e.updateUserInfo(i.data,"headpicUrl")},fail:function(e){console.log("uploadImage fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){console.log("complate")}})},fail:function(t){console.log("chooseImage fail",t)}})}}}}).call(e,a(2).default)},82:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"page"},[a("view",{staticClass:"page-body uni-column"},[a("view",{staticClass:"page-section justify-center align-center"},[a("view",{staticClass:"portrait",attrs:{eventid:"fFJ-0"},on:{tap:t.chooseImage}},[a("view",[a("image",{staticClass:"image",attrs:{src:t.headerImageSrc,mode:"aspectFit"}})]),t._m(0)])]),a("view",{staticClass:"page-section uni-column"},t._l(t.util_list,function(e,s){return a("view",{key:s,staticClass:"util-list justify-center",attrs:{"hover-class":"uni-list-cell-hover",eventid:"ybD-3-"+s},on:{tap:function(a){t.openTag(e)}}},[a("view",{staticClass:"list uni-row"},[a("view",{staticStyle:{flex:"3"}},[a("text",[t._v(t._s(e.name))])]),a("view",{staticStyle:{flex:"7","justify-content":"flex-end"}},["sex"==e.target?a("picker",{staticStyle:{width:"100%","text-align":"right"},attrs:{value:t.sex_index,range:t.sex_array,eventid:"EYO-2-"+s},on:{change:t.bindPickerChange}},[a("text",{staticClass:"uni-input"},[t._v(t._s(t.sex_array[t.sex_index]))])]):"birthday"==e.target?a("picker",{staticStyle:{width:"100%","text-align":"right"},attrs:{mode:"date",value:t.date,start:t.startDate,end:t.endDate,eventid:"h5X-1-"+s},on:{change:t.bindDateChange}},[a("text",{staticClass:"uni-input"},[t._v(t._s(t.date))])]):a("text",[t._v(t._s(e.info))])],1),t._m(1,!0)])])}))])])};s._withStripped=!0;var i={render:s,staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("view",[e("image",{attrs:{src:"../../../static/img/camera.png"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticStyle:{flex:"1","justify-content":"flex-end"}},[this._v("\n\t\t\t\t\t\t "),e("image",{attrs:{src:"../../../static/img/more2.png",mode:""}})])}]};e.a=i}},[78]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/template/userData/userData.js.map